---
title: CompressImage
second_title: Aspose.Slides for .NET API 参考
description: 通过根据形状大小和指定分辨率来减小图像的大小来压缩图像。可选地，它还会删除剪裁区域。
type: docs
weight: 190
url: /zh/aspose.slides/ipicturefillformat/compressimage/
---

## CompressImage(bool, PicturesCompression) {#compressimage}

通过根据形状大小和指定分辨率来减小图像的大小来压缩图像。可选地，它还会删除剪裁区域。

```csharp
public bool CompressImage(bool deleteCroppedAreasOfImage, PicturesCompression resolution)
```

| 参数 | 类型 | 描述 |
| --- | --- | --- |
| deleteCroppedAreasOfImage | 布尔值 | 如果为真，方法将移除图像的剪裁区域，从而可能进一步减小其大小。 |
| resolution | PicturesCompression | 压缩的目标分辨率，指定为[`PicturesCompression`](../../../aspose.slides.export/picturescompression)枚举的值。 |

### 返回值

一个布尔值，指示图像是否成功压缩。如果图像被调整大小或剪裁，则返回`true`，否则返回`false`。

### 异常

| 异常 | 条件 |
| --- | --- |
| ArgumentException | 当分辨率不是有效值时抛出。 |

### 备注

此方法更改图像的大小和分辨率，类似于PowerPoint的“图片格式 -> 压缩图片”功能。

### 示例

以下示例演示如何使用`CompressImage`方法通过设置目标分辨率和移除剪裁区域来减小演示文稿中图像的大小：

```csharp
using (Presentation presentation = new Presentation("demo.pptx"))
{
    ISlide slide = presentation.Slides[0];
    IPictureFrame picFrame = slide.Shapes[0] as IPictureFrame;
    // 以150 DPI（网络分辨率）作为目标分辨率来压缩图像并删除剪裁区域
    bool result = picFrame.PictureFormat.CompressImage(true, PicturesCompression.Dpi150);
}
```

### 另见

* enum [PicturesCompression](../../../aspose.slides.export/picturescompression)
* interface [IPictureFillFormat](../../ipicturefillformat)
* namespace [Aspose.Slides](../../ipicturefillformat)
* assembly [Aspose.Slides](../../../)

---

## CompressImage(bool, float) {#compressimage_1}

通过根据形状大小和指定分辨率来减小图像的大小来压缩图像。可选地，它还会删除剪裁区域。

```csharp
public bool CompressImage(bool deleteCroppedAreasOfImage, float resolution)
```

| 参数 | 类型 | 描述 |
| --- | --- | --- |
| deleteCroppedAreasOfImage | 布尔值 | 如果为真，方法将移除图像的剪裁区域，从而可能进一步减小其大小。 |
| resolution | 单精度浮点数 | 目标分辨率（DPI）。该值必须是正数，并定义图像将如何调整大小。 |

### 返回值

一个布尔值，指示图像是否成功压缩。如果图像被调整大小或剪裁，则返回`true`，否则返回`false`。

### 异常

| 异常 | 条件 |
| --- | --- |
| ArgumentException | 当分辨率不是正值时抛出。 |

### 备注

此方法更改图像的大小和分辨率，类似于PowerPoint的“图片格式 -> 压缩图片”功能。

### 示例

以下示例演示如何使用`CompressImage`方法通过设置目标分辨率和移除剪裁区域来减小演示文稿中图像的大小：

```csharp
[C#]
using (Presentation presentation = new Presentation("demo.pptx"))
{
    ISlide slide = presentation.Slides[0];

    // 获取PictureFrame
    IPictureFrame picFrame = slide.Shapes[0] as IPictureFrame;

    // 以150 DPI（网络分辨率）作为目标分辨率来压缩图像并删除剪裁区域
    bool result=picFrame.PictureFormat.CompressImage(true, 150f); // 网络分辨率
}
```

### 另见

* interface [IPictureFillFormat](../../ipicturefillformat)
* namespace [Aspose.Slides](../../ipicturefillformat)
* assembly [Aspose.Slides](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Slides.dll -->