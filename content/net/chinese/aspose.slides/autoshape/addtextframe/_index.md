---
title: AddTextFrame
second_title: Aspose.Slides for .NET API 参考
description: 向形状添加一个新的文本框。如果形状已经有文本框，则只需更改其文本。
type: docs
weight: 60
url: /zh/aspose.slides/autoshape/addtextframe/
---

## AutoShape.AddTextFrame 方法

向形状添加一个新的文本框。如果形状已经有文本框，则只需更改其文本。

```csharp
public ITextFrame AddTextFrame(string text)
```

| 参数 | 类型 | 描述 |
| --- | --- | --- |
| text | String | 新文本框的默认文本。 |

### 示例

以下示例代码展示了如何在 PowerPoint 演示文稿中添加水印文本。

```csharp
[C#]
	using (var presentation = new Presentation())
	{
		ISlide slide = presentation.Slides[0];
		IAutoShape watermarkShape = slide.Shapes.AddAutoShape(ShapeType.Triangle, 0, 0, 150, 50);
		ITextFrame watermarkTextFrame = watermarkShape.AddTextFrame("水印");
	}
```

以下示例展示了如何在幻灯片上创建文本框。

```csharp
[C#]
// 实例化演示文稿
using (Presentation pres = new Presentation())
{
    // 获取演示文稿中的第一张幻灯片
    ISlide sld = pres.Slides[0];
    // 添加类型设置为矩形的自动形状
    IAutoShape ashp = sld.Shapes.AddAutoShape(ShapeType.Rectangle, 150, 75, 150, 50);
    // 向矩形添加文本框
    ashp.AddTextFrame(" ");
    // 访问文本框
    ITextFrame txtFrame = ashp.TextFrame;
    // 为文本框创建段落对象
    IParagraph para = txtFrame.Paragraphs[0];
    // 为段落创建部分对象
    IPortion portion = para.Portions[0];
    // 设置文本
    portion.Text = "Aspose 文本框";
    // 将演示文稿保存到磁盘
    pres.Save("TextBox_out.pptx", Aspose.Slides.Export.SaveFormat.Pptx);
}
```

以下示例展示了如何在文本框中添加列。

```csharp
[C#]
using (Presentation presentation = new Presentation())
{
	// 获取演示文稿中的第一张幻灯片
	ISlide slide = presentation.Slides[0];
	// 添加类型设置为矩形的自动形状
	IAutoShape aShape = slide.Shapes.AddAutoShape(ShapeType.Rectangle, 100, 100, 300, 300);
	// 向矩形添加文本框
	aShape.AddTextFrame("所有这些列都限制在一个单一的文本容器内 -- " +
	"您可以添加或删除文本，而新文本或剩余文本会自动调整 " +
	"以适应容器。 您不能让文本从一个容器流向另一个容器 -- 我们告诉过您，PowerPoint 对文本的列选项是有限的！");
	// 获取文本框的文本格式
	ITextFrameFormat format = aShape.TextFrame.TextFrameFormat;
	// 指定文本框中的列数
	format.ColumnCount = 3;
	// 指定列之间的间距
	format.ColumnSpacing = 10;
	// 保存演示文稿
	presentation.Save("ColumnCount.pptx", SaveFormat.Pptx);
}
```

### 相关内容

* 接口 [ITextFrame](../../itextframe)
* 类 [AutoShape](../../autoshape)
* 命名空间 [Aspose.Slides](../../autoshape)
* 程序集 [Aspose.Slides](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Slides.dll -->