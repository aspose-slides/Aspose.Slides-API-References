---  
title: CalculateFormulas
second_title: Aspose.Sildes for .NET API Reference  
description: 计算工作簿中的所有公式并更新相应单元格的值。
type: docs  
weight: 20  
url: /zh/aspose.slides.charts/chartdataworkbook/calculateformulas/
---  

## ChartDataWorkbook.CalculateFormulas 方法  

计算工作簿中的所有公式并更新相应单元格的值。  

```csharp  
public void CalculateFormulas()  
```  

### 异常  

| exception | condition |  
| --- | --- |  
| [CellCircularReferenceException](../../../aspose.slides.spreadsheet/cellcircularreferenceexception) | 工作簿包含具有循环引用的公式。 |  
| [CellUnsupportedDataException](../../../aspose.slides.spreadsheet/cellunsupporteddataexception) | 单元格数据不被支持。 |  

### 示例  

示例展示了如何将公式赋值给单元格并计算值。单元格 "B4" 的值被设置为 5。  

```csharp  
[C#]  
using (Presentation pres = new Presentation())  
{  
    IChart chart = pres.Slides[0].Shapes.AddChart(ChartType.Pie, 100, 100, 300, 400);  
    IChartDataWorkbook wb = chart.ChartData.ChartDataWorkbook;  
    wb.GetCell(0, "B2", 2);  
    wb.GetCell(0, "B3", 3);  
    wb.GetCell(0, "B4").Formula = "B2+B3";  
    wb.CalculateFormulas();  
    ...  
}  
```  

### 参见  

* class [ChartDataWorkbook](../../chartdataworkbook)  
* namespace [Aspose.Slides.Charts](../../chartdataworkbook)  
* assembly [Aspose.Slides](../../../)  

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Slides.dll -->  